"use strict";!function(){const t=fetch("https://data.eindhoven.nl/api/records/1.0/search/?dataset=buurten&rows=116&facet=buurtcode&facet=buurtnaam&facet=wijkcode&facet=wijknaam").then(t=>t.json()),e=fetch("https://raw.githubusercontent.com/tue-vll/data/master/Sport2017.json").then(t=>t.json());Promise.all([t,e]).then(t=>{let e=t[0].records,s=t[1],r=e.length,o={type:"FeatureCollection",features:[]};for(let t=0;t<r;t++){let s={type:"Feature",geometry:{type:"Polygon",coordinates:e[t].fields.geo_shape.coordinates},properties:{neighborhood:e[t].fields.buurtnaam}};o.features.push(s)}let p=[];for(let t=0;t<o.features.length;t++){let e=o.features[t].properties;e=e.neighborhood.replace(", ",",");const r=s.filter(t=>t.Buurten==e);p.push(r[0])}for(let t=0;t<o.features.length;t++)o.features[t].properties.sports=p[t]["doet aan sport 2017"];const a=function(){!function(){let t=new L.Map("sp-map").setView([51.46,5.45],11);L.esri.basemapLayer("Gray").addTo(t);let e=d3.geoTransform({point:function(e,s){let r=t.latLngToLayerPoint(new L.LatLng(s,e));this.stream.point(r.x,r.y)}}),s=d3.geoPath().projection(e),r=d3.select(t.getPanes().overlayPane).append("svg"),p=r.append("g").attr("class","leaflet-zoom-hide"),a=p.selectAll("path").data(o.features).enter().append("path");function n(){let t=s.bounds(o),e=t[0],n=t[1];r.attr("width",n[0]-e[0]).attr("height",n[1]-e[1]).style("left",e[0]+"px").style("top",e[1]+"px"),p.attr("transform","translate("+-e[0]+","+-e[1]+")"),a.attr("d",s).style("stroke","rgb(187,187,187)").style("stroke-width","1px").style("fill",t=>t.properties.sports>=70&t.properties.sports<80?"rgb(215,48,31)":t.properties.sports>=60&t.properties.sports<70?"rgb(252,141,89)":t.properties.sports>=50&t.properties.sports<60?"rgb(253,204,138)":t.properties.sports>=40&t.properties.sports<50?"rgb(254,240,217)":"rgb(212,212,212)").attr("class","pointer-release").on("mouseover",t=>{let e;d3.select(this).style("cursor","pointer").transition().style("opacity",.5).duration(200),e=null!==t.properties.sports?'<span class="sp-tooltip_neighbor">'+t.properties.neighborhood+'</span><span "sp-tooltip_value">'+t.properties.sports+"%</span>":'<span class="sp-tooltip_neighbor">'+t.properties.neighborhood+'</span><span "sp-tooltip_value">'+t.properties.sports+"</span>",$("#sp-tooltip").html(e).attr("aria-hidden","false").attr("width","auto").css("left",d3.event.pageX-36+"px").css("top",d3.event.pageY-220+"px")}).on("mouseout",()=>{d3.select(this).transition().style("opacity",1).duration(200),$("#sp-tooltip").attr("aria-hidden","true")})}t.on("moveend",n),n()}()};$(document).ready(()=>{a()})})}();