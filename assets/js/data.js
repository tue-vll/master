"use strict";!function(){const t=fetch("https://data.eindhoven.nl/api/records/1.0/search/?dataset=buurten&rows=116&facet=buurtcode&facet=buurtnaam&facet=wijkcode&facet=wijknaam").then(t=>t.json()),e=fetch("https://raw.githubusercontent.com/tue-vll/data/master/Sport2017.json").then(t=>t.json()),a=fetch("https://raw.githubusercontent.com/tue-vll/data/master/Sport2006-2017.json").then(t=>t.json()),r=fetch("https://raw.githubusercontent.com/tue-vll/data/master/publicLight2017.json").then(t=>t.json());let s,o=[],n=[],l=[],p={},i={},d={};const c=()=>{function c(t){let e=d3.select(t.node().parentNode),a=parseInt(t.style("width")),r=parseInt(t.style("height")),s=a/r;function o(){let a=parseInt(e.style("width"));t.attr("width",a),t.attr("height",Math.round(a/s))}t.attr("viewBox","0 0 "+a+" "+r).attr("perserveAspectRatio","xMinYMid").call(o),d3.select(window).on("resize."+e.attr("id"),o)}t.then(t=>{let a=t.records,r=a.length;p.type="FeatureCollection",p.features=[];for(let t=0;t<r;t++){let e={type:"Feature",geometry:{type:"Polygon",coordinates:a[t].fields.geo_shape.coordinates},properties:{neighborhood:a[t].fields.buurtnaam}};p.features.push(e),l[0]="nb"}e.then(t=>{let e=t,a=[];i=p;for(let t=0;t<i.features.length;t++){let r=i.features[t].properties;r=r.neighborhood.replace(", ",",");const s=e.filter(t=>t.Buurten==r);a.push(s[0])}for(let t=0;t<i.features.length;t++)i.features[t].properties.sports=a[t]["doet aan sport 2017"],l[1]="mp1";let r=function(t,e){let a=new L.Map(t).setView([51.46,5.45],11);L.esri.basemapLayer("Gray").addTo(a);let r=function(){let t=d3.geoTransform({point:function(t,e){let r=a.latLngToLayerPoint(new L.LatLng(e,t));this.stream.point(r.x,r.y)}}),r=d3.geoPath().projection(t),s=d3.select(a.getPanes().overlayPane).append("svg"),o=s.append("g").attr("class","leaflet-zoom-hide"),n=o.selectAll("path").data(i.features).enter().append("path");function l(){let t=r.bounds(i),a=t[0],l=t[1];s.attr("width",l[0]-a[0]).attr("height",l[1]-a[1]).style("left",a[0]+"px").style("top",a[1]+"px"),o.attr("transform","translate("+-a[0]+","+-a[1]+")"),n.attr("d",r).style("stroke","rgb(187,187,187)").style("stroke-width","1px").style("fill",t=>t.properties.sports>=70&t.properties.sports<80?"rgb(215,48,31)":t.properties.sports>=60&t.properties.sports<70?"rgb(252,141,89)":t.properties.sports>=50&t.properties.sports<60?"rgb(253,204,138)":t.properties.sports>=40&t.properties.sports<50?"rgb(254,240,217)":"rgb(212,212,212)").attr("class","pointer-release").style("cursor","pointer").on("mouseover",function(t){let e;d3.select(this).transition().style("opacity",.5).duration(200),e=null!==t.properties.sports?'<span class="mp1-tooltip_neighbor">'+t.properties.neighborhood+'</span><span "mp1-tooltip_value">'+t.properties.sports+"%</span>":'<span class="mp1-tooltip_neighbor">'+t.properties.neighborhood+'</span><span "mp1-tooltip_value">No Data</span>',$("#mp1-tooltip").html(e).attr("aria-hidden","false").attr("width","auto").css("left",d3.mouse(this)[0]+10+"px").css("top",d3.mouse(this)[1]-50+"px")}).on("mouseout",function(){d3.select(this).transition().style("opacity",1).duration(200),$("#mp1-tooltip").attr("aria-hidden","true")}),$(e).attr("aria-hidden","true")}a.on("moveend",l),l()};r(),n[0]=r};r("mp1","#mp1-loader"),o[0]=r})}),a.then(t=>{!function(){let e=t,a=Object.keys(e[0]).length,r=[];for(let t=0;t<e.length;t++){let s={values:[]};for(let r=0;r<a-1;r++){let a=null!==e[t][2006]&&0!==e[t][2006],o=null!==e[t][2007]&&0!==e[t][2007],n=null!==e[t][2008]&&0!==e[t][2008],l=null!==e[t][2009]&&0!==e[t][2009],p=null!==e[t][2010]&&0!==e[t][2010],i=null!==e[t][2011]&&0!==e[t][2011],d=null!==e[t][2012]&&0!==e[t][2012],c=null!==e[t][2013]&&0!==e[t][2013],u=null!==e[t][2014]&&0!==e[t][2014],h=null!==e[t][2015]&&0!==e[t][2015],g=null!==e[t][2016]&&0!==e[t][2016],f=null!==e[t][2017]&&0!==e[t][2017];a&&o&&n&&l&&p&&i&&d&&c&&u&&h&&g&&f&&(s.name="",s.name=e[t].Buurten,s.values[r]={year:Object.keys(e[t])[r],percent:e[t][Object.keys(e[t])[r]]})}void 0!==s.name&&r.push(s),l[2]="ln1"}!function(){let t=r,e=30,a=26,s=80,o=40,n=parseInt(d3.select("#ln1").style("width"))-o-a,l=parseInt(d3.select("#ln1").style("height"))-e-s,p=parseInt(d3.select("#ln1").style("width")),i=parseInt(d3.select("#ln1").style("height"))-40,d=d3.timeParse("%Y");t.forEach(t=>{t.values.forEach(t=>{t.year=d(t.year),t.percent=+t.percent})});let u=d3.scaleTime().range([0,n]),h=d3.scaleLinear().range([l,0]);u.domain(d3.extent(t[0].values,function(t){return t.year})),h.domain([30,90]);let g=d3.axisBottom(u),f=d3.axisLeft(h).ticks(7).tickSize(4),m=d3.axisLeft().tickFormat("").tickSize(-n).scale(h),y=d3.select("#ln1").append("svg").attr("class",()=>{if("Apple Computer, Inc."==navigator.vendor)return"topMargin"}).attr("height",i).attr("width",p).style("cursor","pointer").on("mouseenter",()=>{$(".ln1-group").addClass("in-active")}).on("mouseleave",()=>{$(".ln1-group").removeClass("in-active")}).call(c).attr("transform","translate(0,40)").append("g").attr("width",n).attr("height",l).attr("transform","translate("+o+","+e+")");y.append("g").attr("class","grid").call(m);let w=d3.line().x(t=>u(t.year)).y(t=>h(t.percent));y.append("g").attr("class","ln1lines").selectAll(".ln1line-group").data(t).enter().append("g").attr("class","ln1-group").append("path").attr("class","line").attr("d",t=>w(t.values)).on("mouseover",function(t){this.parentNode.appendChild(this),d3.select(this).classed("active",!0);let e='<span class="ln1-tooltip_neighbor">'+t.name+"</span>";$("#ln1-tooltip").html(e).attr("aria-hidden",!1).attr("width","auto").attr("height","100px").css("left",d3.event.pageX-470+"px").css("top",d3.event.pageY-200+"px")}).on("mouseout",function(){d3.select(this).classed("active",!1),$("#ln1-tooltip").attr("aria-hidden",!0).attr("width","auto").attr("height","auto").css("left",d3.mouse(this)[0]+10+"px").css("top",d3.mouse(this)[1]-50+"px")}),y.append("g").attr("class","ln1-xAxis").attr("transform","translate(0,"+l+")").call(g),y.append("g").attr("class","ln1-yAxis").call(f).call(t=>t.select(".domain").remove()),y.append("text").attr("y",-20).attr("x",0).attr("dy","1em").style("text-anchor","middle").text("percent").style("font-size","10px").style("font-weight","bold"),$("#ln1-loader").attr("aria-hidden","true")}()}()}),r.then(t=>{let e=t;d.type="FeatureCollection",d.features=[];for(let t=0;t<e.length;t++){if(""!==e[t].Kleur&&null!==e[t].Wattage&&e[t].Wattage>=100){let a=e[t].Locat.split(", "),r={type:"Feature",geometry:{type:"Point",coordinates:[parseFloat(a[0]),parseFloat(a[1])]},properties:{color:e[t].Kleur,watt:e[t].Wattage}};d.features.push(r)}l[3]="mp2"}let a=function(t,e){let a=new L.Map(t).setView([51.46,5.45],11);L.esri.basemapLayer("DarkGray").addTo(a);let r=function(){let t=d3.geoTransform({point:function(t,e){let r=a.latLngToLayerPoint(new L.LatLng(t,e));this.stream.point(r.x,r.y)}}),r=d3.geoPath().projection(t),s=d3.select(a.getPanes().overlayPane).append("svg"),o=s.append("g").attr("class","leaflet-zoom-hide"),n=o.selectAll("path").data(d.features).enter().append("path");function l(){let t=r.bounds(d),l=t[0],p=t[1];s.attr("width",p[0]-l[0]).attr("height",p[1]-l[1]).style("left",l[0]+"px").style("top",l[1]+"px"),o.attr("transform","translate("+-l[0]+","+-l[1]+")"),n.attr("d",r).style("fill",t=>"geel"==t.properties.color?"rgb(247,189,48)":"wit"==t.properties.color?"rgb(255,255,255)":"blauw"==t.properties.color?"rgb(81,157,213)":"oranje"==t.properties.color?"rgb(243,112,33)":void 0).style("opacity",t=>t.properties.watt<=100?.5:t.properties.watt>100&&t.properties.watt<=150?.6:t.properties.watt>150&&t.properties.watt<=200?.7:t.properties.watt>200&&t.properties.watt<=250?.8:t.properties.watt>250&&t.properties.watt<=300?.9:t.properties.watt>300?1:void 0);let i=a.getZoom();i<=11?n.attr("d",r.pointRadius([.5])):12==i?n.attr("d",r.pointRadius([.5])):13==i?n.attr("d",r.pointRadius([1])):14==i?n.attr("d",r.pointRadius([2])):15==i?n.attr("d",r.pointRadius([3])):16==i?n.attr("d",r.pointRadius([4])):17==i?n.attr("d",r.pointRadius([5])):18==i?n.attr("d",r.pointRadius([6])):19==i?n.attr("d",r.pointRadius([7])):n.attr("d",r.pointRadius([8])),$(e).attr("aria-hidden","true")}a.on("moveend",l),l()};r(),n[1]=r};a("mp2","#mp2-loader"),o[1]=a}),d3.json("https://raw.githubusercontent.com/tue-vll/data/master/Green.json").then(function(t){s=t,l[4]="mp3";let e=function(t,e){let a=new L.Map(t).setView([51.46,5.45],11);L.esri.basemapLayer("Gray").addTo(a);let r=function(){const t=d3.geoTransform({point:function(t,e){const r=a.latLngToLayerPoint(new L.LatLng(e,t));this.stream.point(r.x,r.y)}}),r=d3.geoPath().projection(t);let o=d3.select(a.getPanes().overlayPane).append("svg"),n=o.append("g").attr("class","leaflet-zoom-hide"),l=n.selectAll("path").data(s.features).enter().append("path");function p(){let t=r.bounds(s),a=t[0],p=t[1];o.attr("width",p[0]-a[0]).attr("height",p[1]-a[1]).style("left",a[0]+"px").style("top",a[1]+"px"),n.attr("transform","translate("+-a[0]+","+-a[1]+")"),l.attr("d",r).style("stroke-width","1px").style("fill",t=>"allotments"==t.properties.fclass?"rgb(237,248,177)":"farm"==t.properties.fclass?"rgb(65,171,93)":"forest"==t.properties.fclass?"rgb(0,68,27)":"grass"==t.properties.fclass?"rgb(173,221,142)":"meadow"==t.properties.fclass?"rgb(247,252,185)":"orchard"==t.properties.fclass?"rgb(199,233,180)":"park"==t.properties.fclass?"rgb(35,132,67)":"rgb(212,212,212)").attr("class","pointer-release").style("cursor","pointer").on("mouseover",function(t){let e;d3.select(this).transition().style("opacity",.5).duration(200),e=null==t.properties.fclass?'<span class="mp3-tooltip_green"> Not Defined </span>':'<span class="mp3-tooltip_green">'+t.properties.fclass+"</span>",$("#mp3-tooltip").html(e).attr("aria-hidden","false").attr("width","auto").css("left",d3.mouse(this)[0]+10+"px").css("top",d3.mouse(this)[1]-10+"px")}).on("mouseout",function(){d3.select(this).transition().style("opacity",1).duration(200),$("#mp3-tooltip").attr("aria-hidden","true")}),$(e).attr("aria-hidden","true")}a.on("moveend",p),p()};r(),n[2]=r};e("mp3","#mp3-loader"),o[2]=e})};$(document).ready(()=>{c()})}();